Initialization
	Add all known users
On request
	If authorization required
		If username known
			If request contains Authorization header
				If response field as expected
					Authorized
				ElseIf stale
					Handle stale
				Else
					Unauthorized
				End
			Else
			End
		Else
			unauthorized
		End
	Else
		Public
	End