In the following, I try to summarize the various areas that http_degist requires to work on.



WWW-Authenticate Response Header
--------------------------------------------------------------

digest-response  
  = 1#( username | realm | nonce | digest-uri
            | response | [ algorithm ] | [cnonce] |
            [opaque] | [message-qop] |
            [nonce-count]  | [auth-param] )

  Make sure that the digset-response really has this format.
  For example, allow LWS, not multiple times the same directive, etc.

  TODO This BNF seems to be quite strange.
  It allows for example the following:
	username, username,
  right?
  Why are some directives (e.g. opaque) declared as optional? Does this make sense in this particular case?
  Does this rule really state that the digest-response MUST have EXACTLY ONE of each of
	username, realm, nonce, digest-uri, response,
  and MUST have ZERO OR ONE of each of
	algorithm, cnonce, opaque, message-qop, nonce-count, auth-para
  ?

nonce
  Provide "good" nonces.
  For now, we only use the same (arbitrary) nonce.
  Low priority.

opaque
  Find out meaning of this value. Why should we use it?
  Provide "good" opaque values.
  For now, we only use the same (arbitrary) opaque.
  Low priority.

algorithm
  Add support for MD5-sess

stale
  Middle priority.

qop-options
  For now, we only use "auth".
  Later, we include "auth-int".
  Then, we also consider "qop" not being present.
  High priority.



Authorization Request Header
--------------------------------------------------------------
For now, we assume the restrictions stated above

nonce-count
  Middle priority

request-digest
  request-digest  = <"> < KD ( H(A1),   unq(nonce-value)
                                        ":" nc-value
                                        ":" unq(cnonce-value)
                                        ":" unq(qop-value)
                                        ":" H(A2)
                              ) <">

A1
  A1  = unq(username-value) ":" unq(realm-value) ":" passwd

A2
  A2  = Method ":" digest-uri-value

400 Bad request
  High priority

Log login failures to detect potential attacks.



Authentication-Info Header
--------------------------------------------------------------
Low priority



MD5
--------------------------------------------------------------
Maybe we need to add/modify some features of the MD5 library.